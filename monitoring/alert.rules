groups:
  - name: ddos_alert_group
    rules:
      - alert: PossibleDDoS
        expr: rate(nginx_http_requests_total[10s]) > 50
        for: 5s
        labels:
          severity: "critical"
        annotations:
          description: "ğŸš¨ Traffic Nginx tÄƒng máº¡nh â†’ nghi ngá» HTTP Flood"
      
      - alert: HighCPUServer
        expr: (1 - avg by (instance)(rate(node_cpu_seconds_total{mode="idle"}[15s]))) > 0.40
        for: 5s
        labels:
          severity: "warning"
        annotations:
          description: "ğŸ”¥ CPU server vÆ°á»£t 40% â†’ kháº£ nÄƒng bá»‹ táº¥n cÃ´ng"
      
      - alert: ConfirmedDDoS
        expr: (rate(nginx_http_requests_total[10s]) > 50) and ((1 - avg by (instance)(rate(node_cpu_seconds_total{mode="idle"}[15s]))) > 0.40)
        for: 5s
        labels:
          severity: "critical"
        annotations:
          description: "ğŸ”¥ XÃC NHáº¬N DDOS: traffic spike + CPU cao"